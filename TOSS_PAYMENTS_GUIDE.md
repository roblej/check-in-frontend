# 토스페이먼츠 연동 가이드

## 1. 환경변수 설정

프로젝트 루트에 `.env.local` 파일을 생성하고 다음 내용을 추가하세요:

```bash
# 토스페이먼츠 설정 (테스트 환경)
NEXT_PUBLIC_TOSS_CLIENT_KEY=
TOSS_SECRET_KEY=

# API URL
NEXT_PUBLIC_API_URL=http://localhost:8888

# 이메일 설정 (SendGrid)
SENDGRID_SMTP_USER=apikey
SENDGRID_SMTP_PASS=your_sendgrid_api_key_here
PAYMENT_NOTIFY_TO=admin@checkin.com
```

## 2. 토스페이먼츠 계정 설정

1. [토스페이먼츠 개발자센터](https://developers.tosspayments.com/)에 접속
2. 계정 생성 및 로그인
3. 테스트 키 발급 (위의 키는 테스트용입니다)
4. 실제 서비스 시에는 라이브 키로 교체 필요

## 3. 결제 플로우

### 결제 요청
- 사용자가 중고 호텔 결제 페이지에서 정보 입력
- 토스페이먼츠 위젯이 렌더링됨
- 결제 버튼 클릭 시 토스페이먼츠 결제 창 열림

### 결제 완료
- 성공 시: `/checkout/success`로 리다이렉트
- 실패 시: `/checkout/fail`로 리다이렉트
- 서버에서 결제 검증 및 처리

## 4. 주요 기능

### 토스페이먼츠 위젯
- 다양한 결제 수단 지원 (카드, 계좌이체, 간편결제 등)
- 브랜드 컬러 커스터마이징
- 반응형 디자인

### 결제 성공 페이지
- QR 코드 생성 (예약 확인서)
- 결제 정보 표시
- 이메일 발송 안내

### 결제 실패 페이지
- 상세한 오류 정보 표시
- 해결 방법 안내
- 재시도 옵션

## 5. 보안 고려사항

- 클라이언트 키는 공개되어도 안전
- 시크릿 키는 서버에서만 사용
- 결제 검증은 서버에서 수행
- HTTPS 사용 필수

## 6. 테스트 카드 정보

테스트 환경에서 사용할 수 있는 카드 정보:

```
카드번호: 4242 4242 4242 4242
만료일: 12/34
CVC: 123
카드비밀번호: 12
```

## 7. 개발 서버 실행

```bash
cd frontend
npm run dev
```

## 8. 문제 해결

### 토스페이먼츠 위젯이 로드되지 않는 경우
- 환경변수 확인
- 네트워크 연결 확인
- 브라우저 콘솔 오류 확인

### 결제 실패 시
- 카드 정보 확인
- 잔액 확인
- 카드사 제한 확인
